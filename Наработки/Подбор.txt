
&НаКлиенте
Процедура ПриОткрытии(Отказ)
	ПроцедураЗаполненияРодителяНоменклатурыНаСервере();
КонецПроцедуры
&НаСервере
Процедура ПроцедураЗаполненияРодителяНоменклатурыНаСервере()
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ Номенклатура.Родитель КАК Ссылка ИЗ Справочник.Номенклатура КАК Номенклатура";
	Выборка = Запрос.Выполнить().Выгрузить();
	
	_ссыль = Неопределено;
	_два = Неопределено;
	_вМассив = Новый Массив;
	Для Каждого _стр ИЗ Выборка Цикл
		_ссыль = _стр.Ссылка;
		Если _ссыль = _два Тогда
			Продолжить
		Иначе
			_ссыль = _стр.Ссылка;
		КонецЕсли;
		_два = _ссыль;
		_вМассив.Добавить(_два);
	КонецЦикла;
	ЗапуститьПостроениеТаблица(_вМассив);
КонецПроцедуры
&НаСервере
Функция ЗапуститьПостроениеТаблица(Параметр)
	Для Каждого _строка ИЗ Параметр Цикл
		НС = ПодборРодителяНоменклатуры.Добавить();
		НС.Группа = _строка.Родитель;
	КонецЦикла;
КонецФункции




ВЫБРАТЬ
	ЦеныНоменклатурыСрезПоследних.Период КАК Период,
	ЦеныНоменклатурыСрезПоследних.Регистратор КАК Регистратор,
	ЦеныНоменклатурыСрезПоследних.НомерСтроки КАК НомерСтроки,
	ЦеныНоменклатурыСрезПоследних.Активность КАК Активность,
	ЦеныНоменклатурыСрезПоследних.ВидЦены КАК ВидЦены,
	ЦеныНоменклатурыСрезПоследних.Номенклатура КАК Номенклатура,
	ЦеныНоменклатурыСрезПоследних.Характеристика КАК Характеристика,
	ЦеныНоменклатурыСрезПоследних.Цена КАК Цена,
	ЦеныНоменклатурыСрезПоследних.Упаковка КАК Упаковка,
	ЦеныНоменклатурыСрезПоследних.Валюта КАК Валюта
ИЗ
	РегистрСведений.ЦеныНоменклатуры.СрезПоследних КАК ЦеныНоменклатурыСрезПоследних
ГДЕ
	ЦеныНоменклатурыСрезПоследних.ВидЦены = &ВидЦены
	И ЦеныНоменклатурыСрезПоследних.Номенклатура.Родитель.Ссылка = &Ссылка

СГРУППИРОВАТЬ ПО
	ЦеныНоменклатурыСрезПоследних.ВидЦены,
	ЦеныНоменклатурыСрезПоследних.Период,
	ЦеныНоменклатурыСрезПоследних.Регистратор,
	ЦеныНоменклатурыСрезПоследних.НомерСтроки,
	ЦеныНоменклатурыСрезПоследних.Активность,
	ЦеныНоменклатурыСрезПоследних.Номенклатура,
	ЦеныНоменклатурыСрезПоследних.Характеристика,
	ЦеныНоменклатурыСрезПоследних.Цена,
	ЦеныНоменклатурыСрезПоследних.Упаковка,
	ЦеныНоменклатурыСрезПоследних.Валюта
